# 屏幕准心软件 (C++ 版本)

一个使用原生 C++ 和 Windows API 开发的高性能屏幕准心工具。无需任何第三方依赖，直接使用系统API实现所有功能。

## ✨ 功能特性

- ✅ **系统托盘运行** - 最小化到系统托盘，不占用任务栏空间
- ✅ **全局快捷键** - 使用 `Ctrl+Shift+C` 快速显示/隐藏准心
- ✅ **多种准心样式** - 支持多种准心类型（丁字、十字、圆点、小圆、指示圈等）
- ✅ **GIF 动画支持** 🎬 - 支持 GIF 格式的动画准心，自动播放动画帧
- ✅ **颜色自定义** 🎨 - 9种颜色可选（红、蓝、绿、黄、紫、青、橙、粉、原色），实时预览
- ✅ **可视化预览** - 双击托盘图标打开预览窗口，网格展示所有准心
- ✅ **始终置顶** - 准心始终显示在所有窗口之上
- ✅ **完全透明** - 鼠标事件穿透，不影响游戏操作
- ✅ **高性能** - 使用原生 C++ 和 GDI+，资源占用极低
- ✅ **即时编译** - 无需安装运行时环境，编译即可使用
- ✅ **自动分组** - 智能识别准心类型并分组显示
- ✅ **缩放控制** - 支持 50%-200% 的准心大小调整

## 🔧 技术实现

- **语言**: C++17
- **API**: Windows API + GDI+
- **窗口**: 分层窗口 (Layered Window)
- **透明**: 鼠标事件穿透 (WS_EX_TRANSPARENT)
- **托盘**: Shell_NotifyIcon API
- **热键**: RegisterHotKey 全局热键

## 📦 编译方法

本项目提供三种编译方式，任选其一：

### 方法1: 使用 MSVC (推荐)

需要安装 Visual Studio 或 Visual Studio Build Tools。

1. 打开 "Developer Command Prompt for VS"
2. 运行编译脚本:
```batch
build.bat
```

或在 VS 命令提示符中手动编译:
```batch
cl /EHsc /O2 /std:c++17 crosshair.cpp /link gdiplus.lib shell32.lib /SUBSYSTEM:WINDOWS /OUT:crosshair.exe
```

### 方法2: 使用 MinGW/GCC

需要安装 MinGW-w64 或 TDM-GCC。

```batch
build_mingw.bat
```

或手动编译:
```batch
g++ -std=c++17 -O2 -mwindows crosshair.cpp -lgdiplus -lshell32 -o crosshair.exe
```

### 方法3: 使用 CMake (跨平台)

需要安装 CMake 和编译器（MSVC 或 MinGW）。

```batch
build_cmake.bat
```

或手动构建:
```batch
mkdir build
cd build
cmake ..
cmake --build . --config Release
```

## 🚀 使用方法

### 第一步：编译程序

选择上述任一编译方法，生成 `crosshair.exe`。

### 第二步：启动程序

**方法1**: 双击 `启动程序.bat`
**方法2**: 直接运行 `crosshair.exe`

### 第三步：使用准心

- 启动后在系统托盘会看到图标
- 按 `Ctrl+Shift+C` 显示/隐藏准心
- **双击托盘图标** 打开可视化预览窗口，点击选择准心
- 右键托盘图标可选择不同的准心样式和颜色
- 支持9种颜色自定义（红、蓝、绿、黄、紫、青、橙、粉、原色）

## 📁 准心分类

程序会自动将 resource 文件夹中的准心图片按类型分组：

- **丁字准心** (6个) - 适合精确瞄准
- **十字准心** (8个) - 经典射击游戏准心
- **圆点准心** (7个) - 简洁的点状准心
- **小圆准心** (4个) - 带圆圈的准心
- **指示圈准心** (7个) - 大圆圈指示准心
- **战术准心** (1个) - 仿真战术瞄准镜

## 🎨 添加自定义准心

1. 将准心图片（PNG/JPG/BMP/GIF格式）放入 `resource` 文件夹
2. 推荐使用 PNG 格式以获得透明背景支持
3. **GIF 动画支持**：程序会自动检测 GIF 动画并播放，支持多帧动画准心
4. 重启程序，新准心会自动出现在菜单中
5. 程序会根据文件名自动分类（如：包含"十字"的图片归入十字准心组）
6. 自定义准心会显示在"自定义"Tab中，支持右键删除功能

## 💡 核心特性说明

### 1. 窗口穿透技术
使用 `WS_EX_TRANSPARENT | WS_EX_LAYERED` 窗口样式，实现鼠标事件完全穿透，不影响游戏操作。

### 2. 透明背景
通过 `SetLayeredWindowAttributes` 设置颜色键透明，只显示准心图案。

### 3. 始终置顶
使用 `WS_EX_TOPMOST` 和 `HWND_TOPMOST` 确保准心始终在最上层。

### 4. 全局热键
通过 `RegisterHotKey` 注册系统级热键，在任何应用中都能响应。

### 5. 系统托盘
使用 `Shell_NotifyIcon` API 实现托盘图标和通知功能。

## 🎮 适用场景

- FPS 射击游戏辅助瞄准
- 需要精确对准的设计软件
- 视频编辑时的中心定位
- 任何需要屏幕中心标记的场景

## ⚡ 性能优势

相比 Python 版本的优势：

- **启动速度**: 即时启动（< 100ms）
- **内存占用**: 约 5-10 MB（Python 版本 > 50 MB）
- **CPU 占用**: 几乎为 0（空闲时）
- **文件大小**: 可执行文件 < 500 KB
- **无依赖**: 不需要安装 Python 或任何库
- **原生体验**: 完美集成 Windows 系统

## 📋 系统要求

- **操作系统**: Windows 7 / 8 / 10 / 11
- **编译器**: 
  - MSVC (Visual Studio 2017+)
  - MinGW-w64 (GCC 7.0+)
  - 或其他支持 C++17 的编译器
- **运行**: 无需任何运行时依赖

## ⚠️ 注意事项

1. **全屏游戏兼容性**
   - 独占全屏模式可能无法显示准心
   - 建议游戏使用"无边框窗口模式"以获得最佳效果

2. **反作弊系统**
   - 部分竞技游戏的反作弊可能检测到该程序
   - 请了解游戏规则后谨慎使用

3. **杀毒软件**
   - 某些杀毒软件可能误报（因使用全局热键等系统API）
   - 可将程序添加到白名单

## 🔍 故障排除

### Q: 编译失败？
- **MSVC**: 确保在 "Developer Command Prompt for VS" 中运行
- **MinGW**: 确保 g++ 在 PATH 环境变量中
- **CMake**: 确保已安装 CMake 和编译器

### Q: 准心不显示？
- 确保已选择了准心样式（右键托盘图标）
- 检查游戏是否为独占全屏模式
- 尝试切换到无边框窗口模式

### Q: 系统托盘图标不显示？
- 检查系统托盘设置，确保未被隐藏
- Windows 10/11 可能需要在设置中允许显示

### Q: 快捷键不起作用？
- 检查是否有其他程序占用了 Ctrl+Shift+C
- 尝试使用托盘菜单或双击图标

### Q: 编译后文件很大？
- 使用 `/O2` 或 `-O2` 优化选项
- 考虑使用 UPX 等工具压缩可执行文件

## 📝 文件说明

```
crosshair/
├── crosshair.cpp          # 主程序源代码
├── CMakeLists.txt         # CMake 配置文件
├── build.bat              # MSVC 编译脚本
├── build_mingw.bat        # MinGW 编译脚本
├── build_cmake.bat        # CMake 编译脚本
├── 启动程序.bat            # 启动脚本
├── README.md              # 说明文档
└── resource/              # 准心图片文件夹
    ├── 丁字 (1).png
    ├── 十字 (1).png
    ├── 圆点 (1).png
    └── ...
```

## 🔄 版本历史

### v1.1.0 (当前版本)
- ✅ **自定义准心模块** - 支持添加、删除自定义准心图片
- ✅ **GIF 动画支持** - 支持 GIF 格式的动画准心，自动播放动画帧
- ✅ **缩放控制** - 支持 50%-200% 的准心大小调整
- ✅ **颜色自定义优化** - 8种颜色可选，实时预览
- ✅ **Tab 分组显示** - 使用 Tab 标签页分组显示不同准心类型
- ✅ **可视化预览窗口** - 双击托盘图标打开预览窗口，网格展示所有准心
- ✅ **右键删除功能** - 自定义准心支持右键删除
- ✅ **配置持久化** - 自动保存用户设置（颜色、缩放、当前准心等）

### v1.0.0
- ✅ 基础功能实现
- ✅ 系统托盘支持
- ✅ 全局热键支持（Ctrl+Shift+C）
- ✅ 多准心切换
- ✅ 自动分组
- ✅ 鼠标穿透
- ✅ 透明背景

## 📄 许可证

本项目仅供学习和个人使用。

## 🤝 贡献

欢迎提交 Issue 和 Pull Request！

---

**提示**: 如果您没有 C++ 编译环境，项目中也提供了 Python 版本（main.py），使用 PyQt5 开发，功能相同。

